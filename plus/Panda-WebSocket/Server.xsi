MODULE = Panda::WebSocket::Server                PACKAGE = Panda::WebSocket::Server
PROTOTYPES: DISABLE

Server* Server::new () {
    RETVAL = new Server();
}

void Server::init (HV* hvcfg) {
    SV** ref;
    ServerConfig config;
    config.loop = NULL;
    
    if ((ref = hv_fetch(hvcfg, "loop", 4, 0))) config.loop = typemap_incast<panda::event::Loop*>(*ref);
    
    PWS_TRY({ THIS->init(config); });
}

void Server::run () {
    THIS->run();
}
